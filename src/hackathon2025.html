<!DOCTYPE html>
<html>

<style>
    /* ADDED: A new CSS class for the images */
    .clothing-preview {
        border: 2px solid #333; /* 2-pixel solid dark grey border */
        border-radius: 5px;     /* Slightly rounded corners */
        padding: 5px;           /* Small space between image and border */
    }
</style>


<body>

<h1> Product Name </h1>

<p> 
    This app lets you update photos of all your clothings and
    the AI system will choose your outfit for the day based on what 
    fit you are going for (athletic, professional, casual, fancy)
</p>

<label for="clothing">Choose image(s) to add</label>
<input type="file" id="clothing" accept="image/*" multiple>

<div id="previewContainer" style="display: flex; flex-wrap: wrap;">
    </div>

<script>
// 1. Array to store objects: { file: FileObject, tag: "tag text" }
let allItems = [];
let allTags = [];

function showClothing() {
    const fileInput = document.getElementById('clothing');
    
    // Get the newly selected files
    const newImages = fileInput.files;

    if (newImages.length === 0) return;

    // Process each new file
    for (let i = 0; i < newImages.length; i++) {
        const file = newImages[i];
        
        // 2. Prompt the user for a tag for this specific image
        const tag = prompt(`Enter a tag for the image: ${file.name}`, 'casual');
        
        // If the user cancels the prompt, skip this file
        if (tag === null) 
            continue;

        const cleanTag = tag.trim() || 'No Tag';

        // 3. Store the file and its tag as a single item in the master array
        allItems.push({
            file: file,
            tag: cleanTag // Use 'No Tag' if the user leaves the input empty
        });

        allTags.push(cleanTag);
    }
    
    // Clear the file input's value
    fileInput.value = ''; 

    // 4. Redraw the entire preview container based on the 'allItems' array
    redrawPreviews();
}

function redrawPreviews() {
    const previewContainer = document.getElementById("previewContainer");
    
    // Clear previous previews entirely
    previewContainer.innerHTML = ''; 

    // Loop through ALL accumulated items (file + tag)
    allItems.forEach(item => {
        const file = item.file;
        const tag = item.tag;

        // Create a container for the image and its tag to keep them together
        const itemWrapper = document.createElement('div');
        itemWrapper.style.margin = '10px';
        itemWrapper.style.textAlign = 'center';
        
        // Use a FileReader to read the file
        const reader = new FileReader();
        reader.onload = function(e) {
            // Create the image element
            const newImage = document.createElement('img');
            newImage.src = e.target.result;
            newImage.width = 300;
            newImage.height = 300;
            newImage.style.display = 'block';

            // Create the tag element
            const tagElement = document.createElement('span');
            tagElement.innerText = "Tag: " + tag;
            tagElement.style.fontWeight = 'bold';
            tagElement.style.display = 'block'; // Make sure the tag is on its own line

            // Assemble the wrapper: Image on top, Tag on bottom
            itemWrapper.appendChild(newImage);
            itemWrapper.appendChild(tagElement);
            
            // Append the whole item (image + tag) to the main container
            previewContainer.appendChild(itemWrapper);
        }

        reader.readAsDataURL(file);
    });
}


// Attach the function to the 'change' event on the file input
document.getElementById('clothing').addEventListener('change', showClothing);

// Since the tag is now set when the image is chosen, 
// there is no need for a separate listener on the old tag input.
</script>

</body>
</html>